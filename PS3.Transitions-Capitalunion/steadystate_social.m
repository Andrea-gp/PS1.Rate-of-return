function f=steadystate_social(x0,param)

kappa=param(1);         %   Desutility factor
sigma=param(2);      	%   Elasticity of consumption
v=param(3);             %   Elasticity of work
nha=param(4);
nhb=param(5);
nla=param(6)
nlab=param(7);
prob_h=param(8);
prob_l=param(9);
phi=param(10);
theta=param(11);
lam_a=param(12);
lam_b=param(13);
g=param(14);
%Initial conditions:
ha=x0(1);
hb=x0(2);
ka=x0(3);
kb=x0(4);
t=x0(5);
c222a=(361*((ha*(wa - (3*ka^(2/5))/(5*ha^(2/5)))*(t - 1))/2)^(4/5))/400 - ka*(ra - (2*ha^(3/5))/(5*ka^(3/5))) + (19*((11*ha*(wa - (3*ka^(2/5))/(5*ha^(2/5)))*(t - 1))/2)^(4/5))/400 + (rb - (2*hb^(3/5))/(5*kb^(3/5)))*(ka - 2);
c222b=(399*((5*hb*(wb - (3*kb^(2/5))/(5*hb^(2/5)))*(t - 1))/2)^(4/5))/500 - kb*(rb - (2*hb^(3/5))/(5*kb^(3/5))) + (21*((7*hb*(wb - (3*kb^(2/5))/(5*hb^(2/5)))*(t - 1))/2)^(4/5))/500 + (ra - (2*ha^(3/5))/(5*ka^(3/5)))*(kb - 2);
%We write the equilibrium conditions:
%Feasibility constraint 
f(1)=c222a+c222b-z*((ka^(1-theta))*(ha^theta))-z*((kb^(1-theta))*(hb^theta));
%Maximum amount of capital:
f(2)=4-ka-kb;
%Marginal utilities:
f(3)=((wa-1.0./hda.^(2.0./5.0).*kda.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*1.0./((ha.*(wa-1.0./hda.^(2.0./5.0).*kda.^(2.0./5.0).*(3.0./5.0)).*(t-1.0))./2.0).^(1.0./5.0).*(3.61e+2./1.0e+3)+(wa-1.0./hda.^(2.0./5.0).*kda.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*1.0./(ha.*(wa-1.0./hda.^(2.0./5.0).*kda.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*(1.1e+1./2.0)).^(1.0./5.0).*(2.09e+2./1.0e+3)).*1.0./(-ka.*(ra-hda.^(3.0./5.0).*1.0./kda.^(3.0./5.0).*(2.0./5.0))+((ha.*(wa-1.0./hda.^(2.0./5.0).*kda.^(2.0./5.0).*(3.0./5.0)).*(t-1.0))./2.0).^(4.0./5.0).*(3.61e+2./4.0e+2)+(ha.*(wa-1.0./hda.^(2.0./5.0).*kda.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*(1.1e+1./2.0)).^(4.0./5.0).*(1.9e+1./4.0e+2)+(rb-hdb.^(3.0./5.0).*1.0./kdb.^(3.0./5.0).*(2.0./5.0)).*(ka-2.0)).^(4.0./5.0);
f(4)=((wb-1.0./hdb.^(2.0./5.0).*kdb.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*1.0./(hb.*(wb-1.0./hdb.^(2.0./5.0).*kdb.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*(5.0./2.0)).^(1.0./5.0).*(3.99e+2./2.5e+2)+(wb-1.0./hdb.^(2.0./5.0).*kdb.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*1.0./(hb.*(wb-1.0./hdb.^(2.0./5.0).*kdb.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*(7.0./2.0)).^(1.0./5.0).*1.176e-1).*1.0./(-kb.*(rb-hdb.^(3.0./5.0).*1.0./kdb.^(3.0./5.0).*(2.0./5.0))+(hb.*(wb-1.0./hdb.^(2.0./5.0).*kdb.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*(5.0./2.0)).^(4.0./5.0).*(3.99e+2./5.0e+2)+(hb.*(wb-1.0./hdb.^(2.0./5.0).*kdb.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*(7.0./2.0)).^(4.0./5.0).*(2.1e+1./5.0e+2)+(ra-hda.^(3.0./5.0).*1.0./kda.^(3.0./5.0).*(2.0./5.0)).*(kb-2.0)).^(4.0./5.0);
f(5)=-1.0./(-ka.*(ra-hda.^(3.0./5.0).*1.0./kda.^(3.0./5.0).*(2.0./5.0))+((ha.*(wa-1.0./hda.^(2.0./5.0).*kda.^(2.0./5.0).*(3.0./5.0)).*(t-1.0))./2.0).^(4.0./5.0).*(3.61e+2./4.0e+2)+(ha.*(wa-1.0./hda.^(2.0./5.0).*kda.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*(1.1e+1./2.0)).^(4.0./5.0).*(1.9e+1./4.0e+2)+(rb-hdb.^(3.0./5.0).*1.0./kdb.^(3.0./5.0).*(2.0./5.0)).*(ka-2.0)).^(4.0./5.0).*(ra-rb-hda.^(3.0./5.0).*1.0./kda.^(3.0./5.0).*(2.0./5.0)+hdb.^(3.0./5.0).*1.0./kdb.^(3.0./5.0).*(2.0./5.0));
f(6)=1.0./(-kb.*(rb-hdb.^(3.0./5.0).*1.0./kdb.^(3.0./5.0).*(2.0./5.0))+(hb.*(wb-1.0./hdb.^(2.0./5.0).*kdb.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*(5.0./2.0)).^(4.0./5.0).*(3.99e+2./5.0e+2)+(hb.*(wb-1.0./hdb.^(2.0./5.0).*kdb.^(2.0./5.0).*(3.0./5.0)).*(t-1.0).*(7.0./2.0)).^(4.0./5.0).*(2.1e+1./5.0e+2)+(ra-hda.^(3.0./5.0).*1.0./kda.^(3.0./5.0).*(2.0./5.0)).*(kb-2.0)).^(4.0./5.0).*(ra-rb-hda.^(3.0./5.0).*1.0./kda.^(3.0./5.0).*(2.0./5.0)+hdb.^(3.0./5.0).*1.0./kdb.^(3.0./5.0).*(2.0./5.0));
f(7)=g-prob_h*(lam_a*(t*wa*ha*nha)^(1-phi))-prob_l*(lam_a*(t*wa*ha*nla)^(1-phi))-prob_h*(lam_b*(t*wb*hb*nhb)^(1-phi))-prob_l*(lam_b*(t*wb*hb*nlb)^(1-phi))
f=f';